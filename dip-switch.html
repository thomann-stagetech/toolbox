<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>DMX Toolbox – DIP</title>
<style>
  :root{
    --primary:#00b5bd;
    --purple:#5c2d91;
    --yellow:#fdd835;
    --bg:#f8f8f8;
    --card:#ffffff;
    --text:#1e1e1e;
    --muted:#666;
    --radius:16px;
    --shadow:0 6px 18px rgba(0,0,0,.08);
    --focus: 0 0 0 3px color-mix(in oklab, var(--primary) 40%, white);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font:16px/1.55 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    color:var(--text);
    background:var(--bg);
  }
  header{
    background:linear-gradient(135deg, var(--primary), color-mix(in oklab, var(--primary) 20%, var(--purple)));
    color:#fff;
    padding:28px 18px;
  }
  header .wrap{max-width:1050px;margin:auto;display:flex;gap:16px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  h1{margin:0;font-size:clamp(22px,3.2vw,30px);letter-spacing:.3px}
  .cta a{
    display:inline-block;background:#fff;color:var(--primary);text-decoration:none;
    padding:10px 14px;border-radius:999px;font-weight:700;border:2px solid transparent;
    box-shadow:var(--shadow)
  }
  .cta a:hover{transform:translateY(-1px)}
  .cta a:focus-visible{outline:none;box-shadow:var(--focus)}
  main{max-width:1050px;margin:26px auto;padding:0 18px 28px}
  .grid{
    display:grid;gap:18px;
    grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
  }
  .card{
    background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;
  }
  .card h2{margin:0 0 8px;font-size:20px}
  .card p{margin:0 0 14px;color:var(--muted)}
  .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
  label{font-weight:600}
  input[type="number"], input[type="text"]{
    width:120px;max-width:100%;
    padding:10px 12px;border-radius:10px;border:1px solid #ddd;background:#fff;
  }
  input:focus-visible{outline:none;box-shadow:var(--focus)}
  .btn{
    appearance:none;border:0;border-radius:10px;padding:10px 14px;
    font-weight:700;cursor:pointer;background:var(--primary);color:#fff;
  }
  .btn.secondary{background:var(--purple)}
  .btn.ghost{
    background:transparent;color:var(--primary);border:2px solid var(--primary)
  }
  .btn:focus-visible{outline:none;box-shadow:var(--focus)}
  .muted{color:var(--muted);font-size:.92rem}
  .pill{
    display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;
    background:color-mix(in oklab, var(--yellow) 18%, white);
    border:1px dashed color-mix(in oklab, var(--yellow) 40%, black);
    color:#5a4a00;font-weight:600
  }

  /* DIP switches */
  .dip-wrap{display:grid;grid-template-columns:repeat(10,1fr);gap:10px;margin-top:12px}
  .dip{
    display:flex;flex-direction:column;align-items:center;gap:6px;
    user-select:none
  }
  .toggle{
    width:44px;height:64px;border-radius:10px;padding:6px;background:#f2f2f2;border:1px solid #ddd;
    box-shadow:inset 0 2px 6px rgba(0,0,0,.08);
    position:relative;display:flex;align-items:flex-end;justify-content:center;
    cursor:pointer;
  }
  .toggle .knob{
    width:36px;height:28px;border-radius:6px;background:#ddd;border:1px solid #c7c7c7;
    transition:transform .15s ease, background .15s ease;
    transform:translateY(0);
  }
  .toggle.on{background:color-mix(in oklab, var(--primary) 18%, white)}
  .toggle.on .knob{background:var(--primary);border-color:color-mix(in oklab, var(--primary) 40%, black);transform:translateY(-28px)}
  .dip .bit{font-size:12px;color:var(--muted)}
  .dip .value{font-weight:700}

 </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>DMX Toolbox</h1>
      <div class="cta">
        <a href="index.html" target="_blank" rel="noopener">Zurück zur Toolbox</a>
      </div>
    </div>
  </header>

  <main class="grid">
    <!-- DIP SWITCH CALC -->
    <section class="card" aria-labelledby="dip-title">
      <h2 id="dip-title">DMX DIP-Switch Calculator</h2>
      <p class="muted">Adresse eingeben oder Schalter klicken. 10 Schalter decken 1–512 ab (1,2,4,…,512).</p>

      <div class="row" style="margin-top:6px">
        <label for="dmxAddr">DMX-Adresse</label>
        <input id="dmxAddr" type="number" min="1" max="512" step="1" value="1" inputmode="numeric" />
        <button class="btn ghost" id="clearDip">Reset</button>
      </div>

      <div class="dip-wrap" id="dipWrap" role="group" aria-label="DIP Schalter 1 bis 10"></div>

      <p class="muted" style="margin-top:10px">
        <span class="pill" title="Hinweis">ℹ️ Für Startadresse 512 wird Schalter „512“ eingeschaltet.</span>
      </p>
    </section>

   
<script>
/* ---------- DMX DIP SWITCH CALCULATOR ---------- */
(() => {
  const dipValues = [1,2,4,8,16,32,64,128,256,512]; // 10 Schalter
  const wrap = document.getElementById('dipWrap');
  const addrInput = document.getElementById('dmxAddr');
  const clearBtn = document.getElementById('clearDip');

  // Build switches
  dipValues.forEach((v, i) => {
    const dip = document.createElement('div');
    dip.className = 'dip';
    dip.innerHTML = `
      <div class="toggle" role="switch" aria-checked="false" tabindex="0" data-value="${v}" aria-label="Schalter ${i+1} Wert ${v}">
        <div class="knob"></div>
      </div>
      <div class="bit">Bit ${i+1}</div>
      <div class="value">${v}</div>
    `;
    wrap.appendChild(dip);
  });

  function currentAddressFromSwitches(){
    let sum = 0;
    wrap.querySelectorAll('.toggle.on').forEach(t => sum += Number(t.dataset.value));
    return sum;
  }

  function setSwitchesFromAddress(addr){
    wrap.querySelectorAll('.toggle').forEach(t => t.classList.remove('on'));
    // Greedy von groß nach klein
    for(let i=dipValues.length-1;i>=0;i--){
      if(addr >= dipValues[i]){
        const t = wrap.querySelector(`.toggle[data-value="${dipValues[i]}"]`);
        t.classList.add('on');
        addr -= dipValues[i];
      }
    }
    // ARIA aktualisieren
    wrap.querySelectorAll('.toggle').forEach(t => t.setAttribute('aria-checked', t.classList.contains('on') ? 'true' : 'false'));
  }

  function clampAddr(n){
    if(!Number.isFinite(n)) return 1;
    n = Math.round(n);
    if(n < 1) n = 1;
    if(n > 512) n = 512;
    return n;
  }

  // Events
  wrap.addEventListener('click', e => {
    const t = e.target.closest('.toggle');
    if(!t) return;
    t.classList.toggle('on');
    t.setAttribute('aria-checked', t.classList.contains('on') ? 'true':'false');
    const sum = currentAddressFromSwitches();
    addrInput.value = sum || 1; // Adresse 0 ist ungültig → min 1
  });

  wrap.addEventListener('keydown', e => {
    const t = e.target.closest('.toggle');
    if(!t) return;
    if(e.key === ' ' || e.key === 'Enter'){
      e.preventDefault();
      t.click();
    }
  });

  addrInput.addEventListener('input', () => {
    const val = clampAddr(Number(addrInput.value));
    addrInput.value = val;
    setSwitchesFromAddress(val);
  });

  clearBtn.addEventListener('click', () => {
    addrInput.value = 1;
    setSwitchesFromAddress(1);
  });

  // Init
  setSwitchesFromAddress(Number(addrInput.value) || 1);
})();

</script>
</body>
</html>
